<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MayUp App</title>
    <script src="https://js.pusher.com/8.0.1/pusher.min.js"></script>
    <style>
        body { font-family: -apple-system, sans-serif; background: #f4f4f9; margin: 0; display: flex; justify-content: center; height: 100vh; }
        .app { width: 100%; max-width: 400px; display: flex; flex-direction: column; background: #fff; box-shadow: 0 0 20px rgba(0,0,0,0.05); }
        #auth { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px; text-align: center; }
        #chat { display: none; flex: 1; flex-direction: column; height: 100%; }
        #msgs { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 8px; background: #fff; }
        .m { padding: 10px 14px; border-radius: 18px; background: #e9e9eb; max-width: 75%; font-size: 15px; line-height: 1.4; }
        .my { background: #007AFF; color: #fff; align-self: flex-end; }
        .input-box { padding: 15px; border-top: 1px solid #eee; display: flex; gap: 10px; background: #fff; }
        input { flex: 1; border: none; background: #f2f2f7; padding: 12px; border-radius: 20px; outline: none; }
        button { border: none; background: #007AFF; color: #fff; padding: 10px 20px; border-radius: 20px; cursor: pointer; font-weight: bold; }
    </style>
</head>
<body>

<div class="app">
    <div id="auth">
        <h1 style="color:#007AFF; font-size: 40px; margin-bottom: 10px;">MayUp</h1>
        <p style="color:#8e8e93; margin-bottom: 30px;">Твой быстрый онлайн-чат</p>
        <input type="text" id="nick" placeholder="Введите ваш ник" style="width: 80%; margin-bottom: 15px; background: #f2f2f7;">
        <button onclick="start()" style="width: 85%;">Войти в онлайн</button>
    </div>

    <div id="chat">
        <div style="padding: 15px; text-align: center; font-weight: bold; border-bottom: 1px solid #eee;">MayUp Online</div>
        <div id="msgs"></div>
        <div class="input-box">
            <input type="text" id="t" placeholder="Сообщение..." onkeypress="if(event.key=='Enter')send()">
            <button onclick="send()">↑</button>
        </div>
    </div>
</div>

<script>
let nick = "";
// Твои данные из скриншота
const pusher = new Pusher('d8fcf154cf12fd101c0b', { cluster: 'eu', forceTLS: true });
const channel = pusher.subscribe('private-mayup');

function start() {
    nick = document.getElementById('nick').value.trim();
    if(!nick) return alert("Придумай ник!");
    document.getElementById('auth').style.display = 'none';
    document.getElementById('chat').style.display = 'flex';
}

// Прием сообщений
channel.bind('client-msg', function(data) {
    showMsg(data.u, data.t, false);
});

function send() {
    const inp = document.getElementById('t');
    if(!inp.value.trim()) return;
    
    const data = { t: inp.value, u: nick };
    
    // Отправка через Pusher
    channel.trigger('client-msg', data);
    
    showMsg(nick, inp.value, true);
    inp.value = '';
}

function showMsg(u, t, isMy) {
    const box = document.getElementById('msgs');
    const div = document.createElement('div');
    div.className = 'm' + (isMy ? ' my' : '');
    div.innerHTML = `<small style="font-size:10px; opacity:0.6; display:block;">${u}</small>${t}`;
    box.appendChild(div);
    box.scrollTop = box.scrollHeight;
}

// Заглушка для авторизации private-канала (нужна для работы Client Events без сервера)
pusher.config.authEndpoint = 'https://pusher.com/static/auth'; 
// Примечание: Для реального приложения нужен свой auth-endpoint, 
// но для теста на Netlify обычно хватает включенных Client Events.
</script>

</body>
</html>
